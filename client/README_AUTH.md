# Система авторизации

## Обзор

Реализована система автоматической проверки токена при загрузке приложения. Теперь при обновлении страницы приложение автоматически проверяет наличие токена в localStorage и его валидность.

## Основные компоненты

### 1. Утилиты авторизации (`src/utils/authUtils.ts`)

- `getStoredToken()` - получение токена из localStorage
- `getStoredUserID()` - получение ID пользователя из localStorage
- `isTokenValid()` - проверка наличия токена и ID пользователя
- `clearStoredAuth()` - очистка данных авторизации из localStorage
- `setStoredAuth(token, userID)` - сохранение данных авторизации

### 2. Redux slice (`src/store/slices/userSlice.ts`)

- `checkAuthToken` - async thunk для проверки валидности токена
- Автоматическая инициализация состояния из localStorage
- Обработка всех сценариев авторизации/деавторизации

### 3. Защищенные маршруты (`src/components/ProtectedRoute/ProtectedRoute.tsx`)

- Автоматическая проверка токена при загрузке
- Редирект на логин при отсутствии/невалидности токена
- Отображение загрузки во время проверки

## Логика работы

1. **При загрузке приложения:**
   - Проверяется наличие токена в localStorage
   - Если токен есть - отправляется запрос на сервер для валидации
   - Если токена нет - редирект на страницу логина

2. **При успешной авторизации:**
   - Токен и ID пользователя сохраняются в localStorage
   - Состояние Redux обновляется
   - Пользователь перенаправляется на главную страницу

3. **При выходе:**
   - Данные очищаются из localStorage
   - Состояние Redux сбрасывается
   - Пользователь перенаправляется на страницу логина

4. **При невалидном токене:**
   - Данные автоматически очищаются из localStorage
   - Пользователь перенаправляется на страницу логина

## Преимущества

- ✅ Автоматическая проверка авторизации при обновлении страницы
- ✅ Безопасное хранение токенов в localStorage
- ✅ Автоматическая очистка невалидных токенов
- ✅ Централизованная логика работы с авторизацией
- ✅ Типизированный код с TypeScript 